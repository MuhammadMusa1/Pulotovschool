<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Интерактивная визуализация алгоритмов сортировки: пузырьковая, выбором, вставками. Обучение программированию для школьников и студентов.">
  <title>Визуализация сортировки | Обучение алгоритмам</title>

  <!-- Open Graph -->
  <meta property="og:title" content="Визуализация алгоритмов сортировки">
  <meta property="og:description" content="Интерактивная демонстрация пузырьковой сортировки, сортировки выбором и вставками.">
  <meta property="og:type" content="website">

  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      text-align: center;
      background: #f9f9f9;
      margin: 0;
      padding: 16px;
      color: #333;
    }
    header h1 {
      font-size: 1.8rem;
      margin: 0.5em 0;
    }
    .intro {
      max-width: 700px;
      margin: 0 auto 20px;
      line-height: 1.6;
      color: #555;
    }
    #controls {
      margin: 15px 0;
    }
    #container {
      display: flex;
      justify-content: center;
      align-items: flex-end;
      height: 280px;
      margin: 20px auto;
      gap: 2px;
    }
    .bar {
      width: calc(100% / 16 - 4px);
      max-width: 32px;
      background: #4CAF50;
      border: 1px solid #333;
      transition: height 0.2s, background-color 0.2s;
    }
    .comparing { background: #ff9800; }
    .swapping   { background: #f44336; }
    .sorted     { background: #2196F3; }
    button, select {
      padding: 8px 14px;
      font-size: 15px;
      margin: 6px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: white;
      cursor: pointer;
    }
    footer {
      margin-top: 30px;
      color: #777;
      font-size: 0.9rem;
    }
    @media (prefers-reduced-motion: reduce) {
      .bar { transition: none; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Визуализация алгоритмов сортировки</h1>
    <p class="intro">
      Интерактивная демонстрация трёх классических алгоритмов: 
      <strong>пузырьковая сортировка</strong>, 
      <strong>сортировка выбором</strong> и 
      <strong>сортировка вставками</strong>. 
      Идеально для школьников и начинающих программистов!
    </p>
  </header>

  <div id="controls" role="group" aria-label="Управление визуализацией">
    <label for="algorithm">Алгоритм:</label>
    <select id="algorithm" aria-label="Выберите алгоритм сортировки">
      <option value="bubble">Пузырьковая</option>
      <option value="selection">Сортировка выбором</option>
      <option value="insertion">Сортировка вставками</option>
    </select>
    <button onclick="generateArray()" aria-label="Сгенерировать новый случайный массив">Новый массив</button>
    <button onclick="startSort()" aria-label="Запустить выбранную сортировку">Запустить</button>
  </div>

  <div id="container" role="region" aria-label="Визуализация массива как столбчатой диаграммы"></div>

  <footer>
    <p>Образовательный инструмент по информатике. Подходит для уроков в школе.</p>
  </footer>

  <script>
    const container = document.getElementById('container');
    const algoSelect = document.getElementById('algorithm');
    let arr = [];
    const ARRAY_SIZE = 16;
    const MAX_VALUE = 100;
    let bars = [];

    function generateArray() {
      arr = Array.from({length: ARRAY_SIZE}, () => Math.floor(Math.random() * MAX_VALUE) + 10);
      renderBars();
    }

    function renderBars() {
      container.innerHTML = '';
      bars = [];
      arr.forEach(val => {
        const bar = document.createElement('div');
        bar.className = 'bar';
        bar.style.height = `${val}%`;
        container.appendChild(bar);
        bars.push(bar);
      });
    }

    function resetBars() {
      bars.forEach(bar => {
        bar.className = 'bar';
      });
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    // Пузырьковая сортировка
    async function bubbleSort() {
      const n = arr.length;
      for (let i = 0; i < n - 1; i++) {
        let swapped = false;
        for (let j = 0; j < n - i - 1; j++) {
          bars[j].classList.add('comparing');
          bars[j + 1].classList.add('comparing');
          await sleep(200);

          if (arr[j] > arr[j + 1]) {
            [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
            [bars[j].style.height, bars[j + 1].style.height] = [bars[j + 1].style.height, bars[j].style.height];
            swapped = true;
          }

          bars[j].classList.remove('comparing');
          bars[j + 1].classList.remove('comparing');
        }
        bars[n - i - 1].classList.add('sorted');
        if (!swapped) break;
      }
      bars.forEach(bar => bar.classList.add('sorted'));
    }

    // Сортировка выбором
    async function selectionSort() {
      const n = arr.length;
      for (let i = 0; i < n - 1; i++) {
        let minIdx = i;
        bars[i].classList.add('comparing');

        for (let j = i + 1; j < n; j++) {
          bars[j].classList.add('comparing');
          await sleep(150);

          if (arr[j] < arr[minIdx]) {
            bars[minIdx].classList.remove('comparing');
            minIdx = j;
            bars[minIdx].classList.add('comparing');
          } else {
            bars[j].classList.remove('comparing');
          }
        }

        if (minIdx !== i) {
          bars[minIdx].classList.add('swapping');
          await sleep(200);
          [arr[i], arr[minIdx]] = [arr[minIdx], arr[i]];
          [bars[i].style.height, bars[minIdx].style.height] = [bars[minIdx].style.height, bars[i].style.height];
          bars[minIdx].classList.remove('swapping');
        }

        bars[i].className = 'bar sorted';
        bars.forEach((b, idx) => {
          if (idx > i) b.classList.remove('comparing');
        });
      }
      bars.forEach(bar => bar.classList.add('sorted'));
    }

    // Сортировка вставками
    async function insertionSort() {
      const n = arr.length;
      for (let i = 1; i < n; i++) {
        let key = arr[i];
        let j = i - 1;

        bars[i].classList.add('comparing');
        await sleep(200);

        while (j >= 0 && arr[j] > key) {
          bars[j].classList.add('comparing');
          await sleep(150);

          arr[j + 1] = arr[j];
          bars[j + 1].style.height = bars[j].style.height;
          bars[j].classList.remove('comparing');
          j--;
        }

        arr[j + 1] = key;
        bars[j + 1].style.height = `${key}%`;
        bars[i].classList.remove('comparing');

        for (let k = 0; k <= i; k++) {
          bars[k].classList.add('sorted');
        }
        for (let k = i + 1; k < n; k++) {
          bars[k].classList.remove('sorted', 'comparing');
        }
        await sleep(100);
      }
      bars.forEach(bar => bar.classList.add('sorted'));
    }

    async function startSort() {
      resetBars();
      const algo = algoSelect.value;
      if (algo === 'bubble') await bubbleSort();
      else if (algo === 'selection') await selectionSort();
      else if (algo === 'insertion') await insertionSort();
    }

    generateArray();
  </script>
</body>
</html>